<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no"
    name="viewport">
  <title>更改个人信息 </title>

  <link rel="stylesheet" href="../dist/modules/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="../dist/modules/ionicons/css/ionicons.min.css">
  <link rel="stylesheet" href="../dist/modules/fontawesome/web-fonts-with-css/css/fontawesome-all.min.css">
  <script src="../dist/modules/jquery.min.js"></script>
  <link rel="stylesheet" href="../dist/css/demo.css">
  <link rel="stylesheet" href="../dist/css/style.css">
  <style>
    .form-group {
      width: 45%;
      float: left;
      margin: 25px;
    }
  </style>
</head>

<body style="background: url('../dist/img/1.jpg');">
  <script>
    var storage = localStorage;
    storage["name"] = window.location.href.split('?')[1].split('=')[1]
    var nameTag = storage.getItem("name")
    var name = decodeURIComponent(nameTag)
  </script>
  <div id="app">
    <section class="section">
      <div class="container mt-5">
        <div class="row">
          <div style=" width:100%;">
            <div class="login-brand">
              信息修改
            </div>

            <div class="card card-primary">
              <!-- style="background:transparent;" -->

              <div class="card-body">
                <form method="POST" action="#" class="needs-validation" novalidate="" onsubmit="return false">

                  <div class="form-group">
                    <label for="user_position">职务</label>
                    <input id="user_position" type="text" class="form-control" name="user_position" tabindex="1"
                      required autofocus>
                    <div class="invalid-feedback">
                      请填写您的职务
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="user_address">校区</label>
                    <input id="user_address" type="text" class="form-control" name="user_address" tabindex="1" required
                      autofocus>
                    <div class="invalid-feedback">
                      请填写您的校区
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="user_age">年龄</label>
                    <input id="user_age" type="text" class="form-control" name="user_age" tabindex="1" required
                      autofocus>
                    <div class="invalid-feedback">
                      请填写您的年龄
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="user_direction">方向</label>
                    <input id="user_direction" type="text" class="form-control" name="user_direction" tabindex="1"
                      required autofocus>
                    <div class="invalid-feedback">
                      请填写您的方向
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="user_target">目标</label>
                    <input id="user_target" type="text" class="form-control" name="user_target" tabindex="1" required
                      autofocus>
                    <div class="invalid-feedback">
                      请填写您的目标
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="user_qq">QQ</label>
                    <input id="user_qq" type="text" class="form-control" name="user_qq" tabindex="1" required autofocus>
                    <div class="invalid-feedback">
                      请填写您的QQ
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="user_grade">年级</label>
                    <input id="user_grade" type="text" class="form-control" name="user_grade" tabindex="1" required
                      autofocus>
                    <div class="invalid-feedback">
                      请填写您的年级
                    </div>
                  </div>

                  <div class="form-group">
                    <label for="user_phone">电话</label>
                    <input id="user_phone" type="text" class="form-control" name="user_phone" tabindex="1" required
                      autofocus>
                    <div class="invalid-feedback">
                      请填写您的电话
                    </div>
                  </div>


                  <div class="form-group">
                    <label for="user_email">电子邮件</label>
                    <input id="user_email" type="email" class="form-control" name="user_email" tabindex="1" required
                      autofocus>
                    <div class="invalid-feedback">
                      请填写您的电子邮件
                    </div>
                  </div>


                  <div>
                    <button type="submit" class="btn btn-primary btn-block" tabindex="4" id="sub">
                      确认修改信息
                    </button>
                  </div>
                </form>
              </div>
            </div>
            <div class="simple-footer">
              Copyright &copy; 工作室 2019
            </div>
          </div>
        </div>
      </div>
      <script>
        let flag = 0;
        document.getElementById("sub").setAttribute("disabled", true);
        $("#user_position").bind('input propertychange', function () {

          if (user_position != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_address").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_age").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_direction").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_target").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_qq").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_grade").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_phone").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        $("#user_email").bind('input propertychange', function () {
          if (user_address != null) {
            flag = flag + 1
            flag1(flag)
          }
        })
        function flag1(flag) {

          if (flag == 9) {
            document.getElementById("sub").removeAttribute("disabled");
          }
        }
        $("[type='submit']").on('click', function () {

          var user_position = $("#user_position").val();
          var user_address = $("#user_address").val();
          var user_age = $("#user_age").val();
          var user_direction = $("#user_direction").val();
          var user_target = $("#user_target").val();
          var user_qq = $("#user_qq").val();
          var user_grade = $("#user_grade").val();
          var user_phone = $("#user_phone").val();
          var user_email = $("#user_email").val();


          var data2 = {
            "param": {
              "user_name": name,
              "user_email": user_email,
              "user_position": user_position,
              "user_address": user_address,
              "user_age": user_age,
              "user_direction": user_direction,
              "user_target": user_target,
              "user_qq": user_qq,
              "user_grade": user_grade,
              "user_phone": user_phone,
              "user_email": user_email,
            }
          }

          var data = JSON.stringify(data2)
          $.ajax({
            type: "POST",
            url: "http://localhost:8081/user/modifydetail",
            contentType: "application/json;charset=utf-8",
            data,
            dataType: "json",
            success: function (data) {
              if (data.data.msg == "修改成功") {
                location.href = 'personal.html?name=' + name
              }

            },
            error: function (message) {
              //失败信息
            }
          });


        })
      </script>
    </section>
  </div>

  <script src="../dist/modules/jquery.min.js"></script>
  <script src="../dist/modules/popper.js"></script>
  <script src="../dist/modules/tooltip.js"></script>
  <script src="../dist/modules/bootstrap/js/bootstrap.min.js"></script>
  <script src="../dist/modules/nicescroll/jquery.nicescroll.min.js"></script>
  <script src="../dist/modules/scroll-up-bar/dist/scroll-up-bar.min.js"></script>
  <script src="../dist/js/sa-functions.js"></script>

  <script src="../dist/js/scripts.js"></script>
  <script src="../dist/js/custom.js"></script>
  <script src="../dist/js/demo.js"></script>
</body>

</html>